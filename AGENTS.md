# Repository Guidelines

## 项目结构与组织方式

- `README.md`：章节索引与外链入口（新增/改名章节需同步更新）。
- 章节目录：`01.*`、`02.*` …（按序号组织的并发专题文章），通常包含 1 篇主文档 `*.md` + 配图（`.png`）。
- `labs/`：可运行示例（按章节存放最小可运行实验，见 `labs/README.md`）。
- `plan.md`：学习/教学计划（章节节奏、复盘模板、Codex 提示词模板）。
- `.idea/`：IDE 工程文件（非必要不改动）。

## 学习与开发约定（JDK 21）

本仓库以文档 + 实验为主，无 Maven/Gradle 依赖；示例默认面向 **JDK 21**。

- 运行前确认版本：`java -version`
- 编译/运行实验（示例）：`cd labs/01-concurrency-pros-cons; javac *.java; java ConcurrencyBenefits ...`
- 提交前自检：`git status`、`git diff`；并在 GitHub 上确认 Markdown/图片可渲染

## 写作规范与命名约定

- 使用 Markdown 标题层级（`#`/`##`/`###`），段落保持简短、要点明确。
- 文件名/目录名尽量保持稳定（重命名会影响外部引用与历史链接）。
- 图片优先使用相对路径，确保仓库内可渲染：`![各种锁对比](./各种锁的对比.png)`
- 新增章节遵循编号递增与命名模式：目录 `28.<标题>`；保持“单主文档”原则，避免同章多份 “v2/final”。
- 新增实验遵循：`labs/NN-<slug>/`（一个实验尽量只验证一个结论），并在该目录 `README.md` 写清楚“如何跑、看什么、如何复盘”。

## 章节内容写作模板（推荐）

为保证“能照着学”，章节文档建议按由浅入深组织（允许按主题微调，但尽量覆盖以下要素）：

- 目标与读者前置：本章要解决什么问题、读者需要哪些基础。
- 先讲动机：现有方案的痛点/限制是什么，本章内容解决什么。
- 核心概念对齐：把名词、角色、关系图（用文字也行）先说清楚。
- 基本用法：给出最小可运行/可迁移的用法（可配 1-2 段短代码）。
- 深入机制：解释关键语义、线程/内存模型、常见实现路径或思维模型。
- 适用边界：什么时候该用、什么时候不该用（尤其是 CPU/IO、资源瓶颈差异）。
- 常见坑与排查：典型反例、定位手段（日志/JVM 参数/线程 dump 等）。
- 配套实验：引用本仓库对应 `labs/NN-xxx`，给出“怎么跑、看什么指标、如何复盘”的指引。
- 小结：用 3-6 条 bullet 复盘本章收获，便于回忆与面试表达。

## 实验 README 写作模板（推荐）

为保证实验“能照着跑、能复盘”，实验目录下的 `README.md` 建议保持同一风格：

- 标题：`# 第 NN 章实验：<主题>`，用一句话说明“本实验要跑出什么结论/直觉”。
- 编译：统一包含 JDK 检查与编译命令（PowerShell 代码块）。
  - `java -version`
  - `cd labs\\NN-xxx`
  - `javac *.java`
- 实验分组：用 `## 实验 A/B/C：<一句话>（\`MainClass\`）` 组织，每个实验提供可直接复制的运行命令（PowerShell 代码块）。
- 观察点：在每个实验后给出 3-6 条“看什么输出/指标/现象”，避免泛泛而谈。
- 复盘模板：最后提供 `## 复盘模板（建议写在笔记里）`，用 4-6 条问题引导总结（本章一句话、关键对比点、边界条件、工程注意点等）。
- 编码建议：文本统一 UTF-8（不带 BOM），避免在 `javac` 下出现 `非法字符: '\\ufeff'`。

## 验证与复盘

- 仓库没有自动化测试；以“可读性 + 可渲染性 + 可复现”为准。
- 文档：确认链接可点击、图片可显示、`README.md` 索引准确。
- 实验：输出应包含关键参数、正确性校验与耗时，便于复盘与对比。

## 提交与 PR 约定

- 提交尽量小而聚焦；历史中既有中文消息，也有 `fix:` 这类前缀。
- 推荐格式（非强制）：`docs: <主题>` / `fix: <问题>` / `chore: <杂项>`
- PR 需说明：改动目的、影响的章节目录；仅在修改配图时附截图对比。

## 面向 Agent 的说明

- 未经明确要求，不调整章节编号/目录结构。
- 修改文章尽量增量改进（补充/修正），避免大段重写导致链接与语义漂移。
- 新增内容优先落地为：章节文档 + 对应 `labs/` 最小实验 + 复盘要点（参考 `plan.md`）。
